---
export const prerender = false;

import { actions, isInputError } from "astro:actions";

const result = Astro.getActionResult(actions.signup);
const inputErrors = isInputError(result?.error) ? result.error.fields : {};
import { ChevronLeft } from "lucide-astro";
import background from "../assets/background.svg";
---

<div
  class="min-h-screen font-['Inter,Roboto,Helvetica_Neue,Arial_Nova,Nimbus_Sans,Arial,sans-serif']"
>
  <img
    id="background"
    src={background.src}
    alt=""
    fetchpriority="high"
    class="fixed top-0 left-0 w-full h-full -z-10 blur-[120px] opacity-80"
  />

  <main
    class="flex flex-col items-center justify-center min-h-screen py-12 px-4"
  >
    <div class="w-full max-w-md">
      <div class="mb-8">
        <a
          href="/"
          class="flex items-center text-blue-600 hover:text-blue-700 mb-6"
        >
          <ChevronLeft class="w-5 h-5 mr-1" />
          Retour
        </a>
        <h1
          class="text-4xl font-extrabold text-gray-900 mb-2 bg-gradient-to-r from-gray-900 to-blue-800 bg-clip-text text-transparent"
        >
          Créer un compte
        </h1>
        <p class="text-lg text-gray-600">
          Commencez à optimiser votre productivité aujourd'hui
        </p>
      </div>

      <div class="bg-white/90 backdrop-blur-lg rounded-2xl p-8 shadow-xl">
        <form method="POST" action={actions.signup} class="space-y-6">
          <div>
            <label
              for="fullName"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Nom complet
            </label>
            <input
              type="text"
              id="fullName"
              name="fullName"
              transition:persist
              class:list={[
                "w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                inputErrors.fullName ? "border-red-300" : "border-gray-300",
              ]}
              required
            />
            {
              inputErrors.fullName && (
                <p class="mt-1 text-sm text-red-600">
                  {inputErrors.fullName.join(", ")}
                </p>
              )
            }
          </div>

          <div>
            <label
              for="email"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Email professionnel
            </label>
            <input
              type="email"
              id="email"
              name="email"
              transition:persist
              class:list={[
                "w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                inputErrors.email ? "border-red-300" : "border-gray-300",
              ]}
              required
            />
            {
              inputErrors.email && (
                <p class="mt-1 text-sm text-red-600">
                  {inputErrors.email.join(", ")}
                </p>
              )
            }
          </div>

          <div>
            <label
              for="companyName"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Nom de l'entreprise
            </label>
            <input
              type="text"
              id="companyName"
              name="companyName"
              transition:persist
              class:list={[
                "w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                inputErrors.companyName ? "border-red-300" : "border-gray-300",
              ]}
              required
            />
            {
              inputErrors.companyName && (
                <p class="mt-1 text-sm text-red-600">
                  {inputErrors.companyName.join(", ")}
                </p>
              )
            }
          </div>

          <div>
            <label
              for="password"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Mot de passe
            </label>
            <input
              type="password"
              id="password"
              name="password"
              transition:persist
              class:list={[
                "w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                inputErrors.password ? "border-red-300" : "border-gray-300",
              ]}
              required
            />
            {
              inputErrors.password && (
                <p class="mt-1 text-sm text-red-600">
                  {inputErrors.password.join(", ")}
                </p>
              )
            }
          </div>

          <div>
            <label
              for="confirmPassword"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Confirmer le mot de passe
            </label>
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              transition:persist
              class:list={[
                "w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                inputErrors.confirmPassword
                  ? "border-red-300"
                  : "border-gray-300",
              ]}
              required
            />
            {
              inputErrors.confirmPassword && (
                <p class="mt-1 text-sm text-red-600">
                  {inputErrors.confirmPassword.join(", ")}
                </p>
              )
            }
          </div>

          <button
            type="submit"
            class="w-full px-6 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1"
          >
            Créer mon compte
          </button>
        </form>

        <p class="mt-6 text-center text-gray-600">
          Vous avez déjà un compte?{" "}
          <a
            href="/login"
            class="text-blue-600 hover:text-blue-700 font-medium"
          >
            Se connecter
          </a>
        </p>
      </div>
    </div>
  </main>
</div>
